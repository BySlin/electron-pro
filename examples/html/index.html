<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Electron-Pro-Test</title>
</head>
<body>
<h1>Electron-Pro测试</h1>
<br/>
<button onclick="ep.testController.test().then(console.log)">测试与主进程通讯</button>
<br/>
<button id="onMainEvent" onclick="onMainEvent()">监听主进程返回</button>
<button onclick="removeMainEvent()">移除主进程监听</button>
</body>
<script>
  let testCallback = undefined;

  function onMainEvent() {
    removeMainEvent();
    testCallback = function (e, message) {
      console.log(message);
      document.getElementById('onMainEvent').innerHTML = `监听主进程返回 ${message}`;
    }
    ep.testMainWindow.onTest(testCallback);
  }

  function removeMainEvent() {
    if (testCallback) {
      ep.testMainWindow.removeTest(testCallback);
      testCallback = undefined;
    }
  }
</script>
</html>
